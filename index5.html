<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Текст-Трансформер</title>
    <style>
        :root {
            --primary-color: #6200ee;
            --primary-dark: #3700b3;
            --secondary-color: #03dac6;
            --background: #f5f5f5;
            --surface: #ffffff;
            --error: #b00020;
            --on-primary: #ffffff;
            --on-secondary: #000000;
            --on-background: #000000;
            --on-surface: #000000;
            --on-error: #ffffff;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --background: #121212;
                --surface: #1e1e1e;
                --on-background: #ffffff;
                --on-surface: #ffffff;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--on-background);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 16px;
            line-height: 1.5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            color: var(--primary-color);
            text-align: center;
        }

        .card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        @media (prefers-color-scheme: dark) {
            .card {
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            }
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            resize: vertical;
            font-size: 16px;
            background-color: var(--surface);
            color: var(--on-surface);
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 8px;
            margin-top: 12px;
        }

        @media (max-width: 480px) {
            .button-group {
                grid-template-columns: 1fr;
            }
        }

        button {
            background-color: var(--primary-color);
            color: var(--on-primary);
            border: none;
            border-radius: 8px;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        button.secondary:hover {
            background-color: rgba(98, 0, 238, 0.08);
        }

        button.success {
            background-color: #4caf50;
        }

        button.success:hover {
            background-color: #3d8b40;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--on-surface);
            opacity: 0.8;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            gap: 8px;
        }

        .stats span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .icon {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .hidden {
            display: none;
        }

        .result-container {
            transition: all 0.3s;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }

        .result-container.visible {
            max-height: 500px;
            opacity: 1;
        }

        .fab {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 10;
            transition: all 0.2s;
        }

        .fab:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .fab:active {
            transform: translateY(0);
        }

        .snackbar {
            position: fixed;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #323232;
            color: white;
            padding: 14px 24px;
            border-radius: 4px;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
            transition: bottom 0.3s;
            z-index: 100;
        }

        .snackbar.show {
            bottom: 20px;
        }

        @media (max-width: 600px) {
            .snackbar {
                width: calc(100% - 32px);
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Текст-Трансформер</h1>
        
        <div class="card">
            <textarea id="inputText" placeholder="Введите текст или вставьте из буфера обмена..."></textarea>
            
            <div class="button-group">
                <button id="pasteBtn" class="secondary">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M19,20H5V4H7V7H17V4H19M12,2A1,1 0 0,1 13,3A1,1 0 0,1 12,4A1,1 0 0,1 11,3A1,1 0 0,1 12,2M19,2H14.82C14.4,0.84 13.3,0 12,0C10.7,0 9.6,0.84 9.18,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V4A2,2 0 0,0 19,2Z"/>
                    </svg>
                    Вставить
                </button>
                <button id="clearBtn" class="secondary">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"/>
                    </svg>
                    Очистить
                </button>
            </div>
            
            <div class="stats">
                <span>
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M13,3H11V13H13V3M17.83,5.72L16.41,4.3C15.55,3.45 14.3,3.03 13.05,3.03C11.8,3.03 10.55,3.45 9.69,4.3L8.27,5.72C7.42,6.57 7,7.82 7,9.07H9C9,8.24 9.31,7.41 9.93,6.79C10.55,6.17 11.38,5.86 12.21,5.86C13.04,5.86 13.87,6.17 14.49,6.79C15.11,7.41 15.42,8.24 15.42,9.07H17.42C17.42,7.82 17,6.57 16.15,5.72M19.23,15.26L17.71,13.75L16.7,14.76L18.22,16.27C17.5,17.27 16.5,18.04 15.29,18.55C14.08,19.06 12.79,19.29 11.5,19.24C10.21,19.19 8.94,18.86 7.77,18.26C6.59,17.66 5.55,16.8 4.75,15.75L6.27,14.24C6.88,15.08 7.71,15.71 8.65,16.11C9.59,16.5 10.62,16.71 11.66,16.71C12.7,16.71 13.73,16.5 14.67,16.11C15.61,15.71 16.44,15.08 17.05,14.24L16.04,13.23L17.55,11.72L19.07,13.23C19.67,14.23 20,15.42 20,16.61H22C22,14.93 21.5,13.25 20.61,11.83C19.72,10.41 18.47,9.3 17,8.55V11H15V7H19V9H16.55C18.06,9.89 19.35,11.19 20.24,12.89C21.13,14.59 21.63,16.5 21.63,18.46C21.61,18.5 20.63,14.43 19.23,15.26Z"/>
                    </svg>
                    Символов: <span id="charCount">0</span>
                </span>
                <span>
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                    </svg>
                    Слов: <span id="wordCount">0</span>
                </span>
                <span>
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3M6,7A2,2 0 0,0 4,9V17H6V13H8V17H10V9A2,2 0 0,0 8,7H6M6,9H8V11H6V9M12,7A2,2 0 0,0 10,9V15A2,2 0 0,0 12,17H14A2,2 0 0,0 16,15V9A2,2 0 0,0 14,7H12M12,9H14V15H12V9M18,7A2,2 0 0,0 16,9V11A2,2 0 0,0 18,13H20V15H16V17H20A2,2 0 0,0 22,15V13A2,2 0 0,0 20,11H18V9H22V7H18Z"/>
                    </svg>
                    Кодировка: <span id="encoding">не определена</span>
                </span>
            </div>
        </div>
        
        <div class="button-group">
            <button id="upperCaseBtn">В ВЕРХНИЙ РЕГИСТР</button>
            <button id="lowerCaseBtn">в нижний регистр</button>
            <button id="sentenceCaseBtn">С заглавной буквы</button>
            <button id="toRussianBtn">На русскую</button>
            <button id="toEnglishBtn">На английскую</button>
            <button id="toUTF8Btn">В UTF-8</button>
            <button id="toWin1251Btn">В Windows-1251</button>
        </div>
        
        <div class="card result-container" id="resultContainer">
            <h2>Результат</h2>
            <textarea id="outputText" readonly></textarea>
            
            <div class="button-group">
                <button id="copyResultBtn" class="success">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/>
                    </svg>
                    Копировать
                </button>
            </div>
            
            <div class="stats">
                <span>
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M13,3H11V13H13V3M17.83,5.72L16.41,4.3C15.55,3.45 14.3,3.03 13.05,3.03C11.8,3.03 10.55,3.45 9.69,4.3L8.27,5.72C7.42,6.57 7,7.82 7,9.07H9C9,8.24 9.31,7.41 9.93,6.79C10.55,6.17 11.38,5.86 12.21,5.86C13.04,5.86 13.87,6.17 14.49,6.79C15.11,7.41 15.42,8.24 15.42,9.07H17.42C17.42,7.82 17,6.57 16.15,5.72M19.23,15.26L17.71,13.75L16.7,14.76L18.22,16.27C17.5,17.27 16.5,18.04 15.29,18.55C14.08,19.06 12.79,19.29 11.5,19.24C10.21,19.19 8.94,18.86 7.77,18.26C6.59,17.66 5.55,16.8 4.75,15.75L6.27,14.24C6.88,15.08 7.71,15.71 8.65,16.11C9.59,16.5 10.62,16.71 11.66,16.71C12.7,16.71 13.73,16.5 14.67,16.11C15.61,15.71 16.44,15.08 17.05,14.24L16.04,13.23L17.55,11.72L19.07,13.23C19.67,14.23 20,15.42 20,16.61H22C22,14.93 21.5,13.25 20.61,11.83C19.72,10.41 18.47,9.3 17,8.55V11H15V7H19V9H16.55C18.06,9.89 19.35,11.19 20.24,12.89C21.13,14.59 21.63,16.5 21.63,18.46C21.61,18.5 20.63,14.43 19.23,15.26Z"/>
                    </svg>
                    Символов: <span id="resultCharCount">0</span>
                </span>
            </div>
        </div>
    </div>
    
    <div class="fab" id="scrollToTopBtn">
        <svg class="icon" viewBox="0 0 24 24">
            <path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z"/>
        </svg>
    </div>
    
    <div class="snackbar" id="snackbar"></div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы
            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const pasteBtn = document.getElementById('pasteBtn');
            const clearBtn = document.getElementById('clearBtn');
            const copyResultBtn = document.getElementById('copyResultBtn');
            const resultContainer = document.getElementById('resultContainer');
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            const snackbar = document.getElementById('snackbar');
            
            // Кнопки преобразования
            const upperCaseBtn = document.getElementById('upperCaseBtn');
            const lowerCaseBtn = document.getElementById('lowerCaseBtn');
            const sentenceCaseBtn = document.getElementById('sentenceCaseBtn');
            const toRussianBtn = document.getElementById('toRussianBtn');
            const toEnglishBtn = document.getElementById('toEnglishBtn');
            const toUTF8Btn = document.getElementById('toUTF8Btn');
            const toWin1251Btn = document.getElementById('toWin1251Btn');
            
            // Статистика
            const charCount = document.getElementById('charCount');
            const wordCount = document.getElementById('wordCount');
            const encoding = document.getElementById('encoding');
            const resultCharCount = document.getElementById('resultCharCount');
            
            // Обработчики событий
            inputText.addEventListener('input', updateStats);
            pasteBtn.addEventListener('click', pasteFromClipboard);
            clearBtn.addEventListener('click', clearInput);
            copyResultBtn.addEventListener('click', copyResult);
            scrollToTopBtn.addEventListener('click', scrollToTop);
            
            // Кнопки преобразования
            upperCaseBtn.addEventListener('click', () => transformText('upper'));
            lowerCaseBtn.addEventListener('click', () => transformText('lower'));
            sentenceCaseBtn.addEventListener('click', () => transformText('sentence'));
            toRussianBtn.addEventListener('click', () => transformText('toRussian'));
            toEnglishBtn.addEventListener('click', () => transformText('toEnglish'));
            toUTF8Btn.addEventListener('click', () => transformText('toUTF8'));
            toWin1251Btn.addEventListener('click', () => transformText('toWin1251'));
            
            // Обновление статистики
            function updateStats() {
                const text = inputText.value;
                const chars = text.length;
                const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
                const detectedEncoding = detectEncoding(text);
                
                charCount.textContent = chars;
                wordCount.textContent = words;
                encoding.textContent = detectedEncoding;
            }
            
            // Определение кодировки (упрощенный вариант)
            function detectEncoding(text) {
                // Простая проверка на UTF-8 (более сложные проверки требуют больше кода)
                try {
                    if (window.TextEncoder) {
                        new TextEncoder().encode(text);
                        return 'UTF-8';
                    }
                    return 'не определена';
                } catch (e) {
                    return 'не UTF-8';
                }
            }
            
            // Вставка из буфера обмена
            async function pasteFromClipboard() {
                try {
                    const clipboardText = await navigator.clipboard.readText();
                    inputText.value = clipboardText;
                    updateStats();
                    showSnackbar('Текст вставлен из буфера обмена');
                } catch (err) {
                    showSnackbar('Не удалось получить доступ к буферу обмена');
                    console.error('Failed to read clipboard contents: ', err);
                }
            }
            
            // Очистка поля ввода
            function clearInput() {
                inputText.value = '';
                outputText.value = '';
                resultContainer.classList.remove('visible');
                updateStats();
                resultCharCount.textContent = '0';
                showSnackbar('Поле очищено');
            }
            
            // Преобразование текста
            function transformText(operation) {
                const text = inputText.value;
                if (!text.trim()) {
                    showSnackbar('Введите текст для преобразования');
                    return;
                }
                
                let result;
                
                switch (operation) {
                    case 'upper':
                        result = text.toUpperCase();
                        break;
                    case 'lower':
                        result = text.toLowerCase();
                        break;
                    case 'sentence':
                        result = text.toLowerCase().replace(/(^\s*\w|[.!?]\s*\w)/g, function(c) {
                            return c.toUpperCase();
                        });
                        break;
                    case 'toRussian':
                        result = switchLayout(text, 'en', 'ru');
                        break;
                    case 'toEnglish':
                        result = switchLayout(text, 'ru', 'en');
                        break;
                    case 'toUTF8':
                        // В реальности простое преобразование в UTF-8 не меняет текст
                        // Это демонстрационная функция
                        result = text;
                        showSnackbar('Текст уже в UTF-8 (Unicode)');
                        break;
                    case 'toWin1251':
                        // В реальности требуется сложное преобразование
                        // Это демонстрационная функция
                        result = text;
                        showSnackbar('Преобразование в Windows-1251 требует серверной обработки');
                        break;
                    default:
                        result = text;
                }
                
                outputText.value = result;
                resultCharCount.textContent = result.length;
                resultContainer.classList.add('visible');
                
                if (!['toUTF8', 'toWin1251'].includes(operation)) {
                    showSnackbar('Текст преобразован');
                }
                
                // Прокрутка к результату
                setTimeout(() => {
                    resultContainer.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            }
            
            // Смена раскладки (русская/английская)
            function switchLayout(text, from, to) {
                const layout = {
                    'en': 'qwertyuiop[]asdfghjkl;\'zxcvbnm,./`QWERTYUIOP{}ASDFGHJKL:"ZXCVBNM<>?~@#$^&|',
                    'ru': 'йцукенгшщзхъфывапролджэячсмитьбю.ёЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ,Ё"№;:?/'
                };
                
                let result = '';
                
                for (let i = 0; i < text.length; i++) {
                    const char = text[i];
                    const index = layout[from].indexOf(char);
                    
                    if (index >= 0) {
                        result += layout[to][index] || char;
                    } else {
                        result += char;
                    }
                }
                
                return result;
            }
            
            // Копирование результата
            async function copyResult() {
                if (!outputText.value.trim()) {
                    showSnackbar('Нет результата для копирования');
                    return;
                }
                
                try {
                    await navigator.clipboard.writeText(outputText.value);
                    showSnackbar('Результат скопирован в буфер обмена');
                } catch (err) {
                    showSnackbar('Не удалось скопировать текст');
                    console.error('Failed to copy text: ', err);
                }
            }
            
            // Показать уведомление
            function showSnackbar(message) {
                snackbar.textContent = message;
                snackbar.classList.add('show');
                
                setTimeout(() => {
                    snackbar.classList.remove('show');
                }, 3000);
            }
            
            // Прокрутка вверх
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            // Показать/скрыть кнопку прокрутки вверх
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    scrollToTopBtn.style.display = 'flex';
                } else {
                    scrollToTopBtn.style.display = 'none';
                }
            });
            
            // Инициализация
            updateStats();
        });
    </script>
</body>
</html>
