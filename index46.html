<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–¢–æ—Ä–≥–æ–≤–∞—è –ò–º–ø–µ—Ä–∏—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            font-family: 'Arial', sans-serif;
        }
        body {
            background: #0a0a1a;
            color: #e0e0e0;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            position: fixed;
        }
        #game {
            padding: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .header {
            display: flex;
            justify-content: space-between;
            background: #1a1a3a;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .currency {
            display: flex;
            gap: 15px;
        }
        .resources {
            background: #1a1a3a;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .market, .buildings, .events {
            background: #1a1a3a;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            max-height: 20vh;
            overflow-y: auto;
        }
        button {
            background: #3a5a8a;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 5px;
            margin: 3px 0;
            cursor: pointer;
            width: 100%;
        }
        button:disabled {
            background: #333;
        }
        .event {
            color: #ffcc00;
            margin: 5px 0;
            font-style: italic;
        }
        .negative { color: #ff5555; }
        .positive { color: #55ff55; }
        h3 { margin-bottom: 5px; }
        @media (max-width: 600px) {
            .currency { flex-wrap: wrap; gap: 5px; }
        }
    </style>
</head>
<body>
    <div id="game">
        <div class="header">
            <div class="currency">
                <span id="gold">üí∞ 0</span>
                <span id="silver">üî∂ 0</span>
                <span id="gems">üíé 0</span>
                <span id="credits">üè¶ 0</span>
            </div>
            <span id="day">–î–µ–Ω—å 1</span>
        </div>
        
        <div class="resources">
            <h3>üì¶ –†–µ—Å—É—Ä—Å—ã</h3>
            <div id="resourcesList"></div>
        </div>
        
        <div class="market">
            <h3>üè™ –†—ã–Ω–æ–∫</h3>
            <div id="marketList"></div>
        </div>
        
        <div class="buildings">
            <h3>üèóÔ∏è –ó–¥–∞–Ω–∏—è</h3>
            <button id="buyFarm">–ö—É–ø–∏—Ç—å —Ñ–µ—Ä–º—É (100üí∞)</button>
            <button id="buyMine">–ö—É–ø–∏—Ç—å —à–∞—Ö—Ç—É (200üí∞)</button>
            <button id="buyWorkshop">–ö—É–ø–∏—Ç—å –º–∞—Å—Ç–µ—Ä—Å–∫—É—é (500üí∞)</button>
        </div>
        
        <div class="events">
            <h3>üìú –°–æ–±—ã—Ç–∏—è</h3>
            <div id="eventsLog"></div>
        </div>
    </div>

    <script>
        // ========== –ò–ì–†–û–í–´–ï –î–ê–ù–ù–´–ï ==========
        let day = 1;
        let gold = 100;
        let silver = 0;
        let gems = 0;
        let credits = 0;
        
        // –†–µ—Å—É—Ä—Å—ã
        const resources = {
            grain: 0,
            ore: 0,
            tools: 0
        };
        
        // –ó–¥–∞–Ω–∏—è
        const buildings = {
            farm: 0,
            mine: 0,
            workshop: 0
        };
        
        // –¶–µ–Ω—ã –Ω–∞ —Ä—ã–Ω–∫–µ (–º–µ–Ω—è—é—Ç—Å—è)
        let marketPrices = {
            grain: 5,
            ore: 10,
            tools: 30
        };
        
        // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        const possibleEvents = [
            { text: "‚õàÔ∏è –ù–∞–≤–æ–¥–Ω–µ–Ω–∏–µ! –£—Ä–æ–∂–∞–π –∑–µ—Ä–Ω–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω.", effect: () => resources.grain = 0, type: "negative" },
            { text: "ü§ë –ù–∞–π–¥–µ–Ω—ã –¥—Ä–µ–≤–Ω–∏–µ —Å–æ–∫—Ä–æ–≤–∏—â–∞! +50üí∞", effect: () => gold += 50, type: "positive" },
            { text: "üë®‚Äçüåæ –ú–∏–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—á–∏—Ö! –§–µ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ª—É—á—à–µ.", effect: () => buildings.farm += 1, type: "positive" },
            { text: "üí∏ –ö—Ä–∏–∑–∏—Å! –¶–µ–Ω—ã —É–ø–∞–ª–∏ –≤–¥–≤–æ–µ.", effect: () => Object.keys(marketPrices).forEach(k => marketPrices[k] = Math.max(1, marketPrices[k] / 2)), type: "negative" }
        ];
        
        // ========== DOM –≠–õ–ï–ú–ï–ù–¢–´ ==========
        const goldDisplay = document.getElementById('gold');
        const silverDisplay = document.getElementById('silver');
        const gemsDisplay = document.getElementById('gems');
        const creditsDisplay = document.getElementById('credits');
        const dayDisplay = document.getElementById('day');
        const resourcesList = document.getElementById('resourcesList');
        const marketList = document.getElementById('marketList');
        const eventsLog = document.getElementById('eventsLog');
        
        // ========== –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê ==========
        function updateUI() {
            // –í–∞–ª—é—Ç—ã
            goldDisplay.textContent = `üí∞ ${gold}`;
            silverDisplay.textContent = `üî∂ ${silver}`;
            gemsDisplay.textContent = `üíé ${gems}`;
            creditsDisplay.textContent = `üè¶ ${credits}`;
            dayDisplay.textContent = `–î–µ–Ω—å ${day}`;
            
            // –†–µ—Å—É—Ä—Å—ã
            resourcesList.innerHTML = Object.entries(resources)
                .map(([res, val]) => `${res}: ${val}`)
                .join("<br>");
            
            // –†—ã–Ω–æ–∫
            marketList.innerHTML = Object.entries(marketPrices)
                .map(([res, price]) => `${res}: ${price}üí∞ <button onclick="buyResource('${res}')">–ö—É–ø–∏—Ç—å</button> <button onclick="sellResource('${res}')">–ü—Ä–æ–¥–∞—Ç—å</button>`)
                .join("<br>");
            
            // –ó–¥–∞–Ω–∏—è
            document.getElementById('buyFarm').textContent = `–§–µ—Ä–º–∞ (${buildings.farm}) - 100üí∞`;
            document.getElementById('buyMine').textContent = `–®–∞—Ö—Ç–∞ (${buildings.mine}) - 200üí∞`;
            document.getElementById('buyWorkshop').textContent = `–ú–∞—Å—Ç–µ—Ä—Å–∫–∞—è (${buildings.workshop}) - 500üí∞`;
        }
        
        // –ü–æ–∫—É–ø–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
        function buyResource(resource) {
            if (gold >= marketPrices[resource]) {
                gold -= marketPrices[resource];
                resources[resource]++;
                updateUI();
            }
        }
        
        // –ü—Ä–æ–¥–∞–∂–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
        function sellResource(resource) {
            if (resources[resource] > 0) {
                resources[resource]--;
                gold += marketPrices[resource];
                updateUI();
            }
        }
        
        // –ü–æ–∫—É–ø–∫–∞ –∑–¥–∞–Ω–∏–π
        document.getElementById('buyFarm').addEventListener('click', () => {
            if (gold >= 100) {
                gold -= 100;
                buildings.farm++;
                updateUI();
            }
        });
        
        document.getElementById('buyMine').addEventListener('click', () => {
            if (gold >= 200) {
                gold -= 200;
                buildings.mine++;
                updateUI();
            }
        });
        
        document.getElementById('buyWorkshop').addEventListener('click', () => {
            if (gold >= 500) {
                gold -= 500;
                buildings.workshop++;
                updateUI();
            }
        });
        
        // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        function triggerRandomEvent() {
            if (Math.random() < 0.3) { // 30% —à–∞–Ω—Å —Å–æ–±—ã—Ç–∏—è
                const event = possibleEvents[Math.floor(Math.random() * possibleEvents.length)];
                event.effect();
                
                const eventElement = document.createElement('div');
                eventElement.className = `event ${event.type}`;
                eventElement.textContent = event.text;
                eventsLog.prepend(eventElement);
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ª–æ–≥–∞
                if (eventsLog.children.length > 5) {
                    eventsLog.removeChild(eventsLog.lastChild);
                }
            }
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª (1 –¥–µ–Ω—å = 10 —Å–µ–∫—É–Ω–¥)
        function gameLoop() {
            day++;
            
            // –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
            resources.grain += buildings.farm;
            resources.ore += buildings.mine;
            if (resources.ore >= 2 && buildings.workshop > 0) {
                resources.ore -= 2;
                resources.tools += buildings.workshop;
            }
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω
            Object.keys(marketPrices).forEach(res => {
                marketPrices[res] = Math.max(1, marketPrices[res] + Math.floor(Math.random() * 5) - 2);
            });
            
            // –°–æ–±—ã—Ç–∏—è
            triggerRandomEvent();
            
            // –ö—Ä–µ–¥–∏—Ç—ã (—Ä–∞–∑ –≤ 5 –¥–Ω–µ–π)
            if (day % 5 === 0) credits += 10;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏—è
            if (gold < -100) {
                alert(`üíÄ –ë–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–æ! –í–∞—à–∞ –∏–º–ø–µ—Ä–∏—è –ø–∞–ª–∞ –Ω–∞ ${day} –¥–µ–Ω—å.`);
                resetGame();
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
            if (gold > 10000) {
                alert(`üèÜ –ü–æ–±–µ–¥–∞! –í—ã —Å–æ–∑–¥–∞–ª–∏ –≤–µ–ª–∏–∫—É—é —Ç–æ—Ä–≥–æ–≤—É—é –∏–º–ø–µ—Ä–∏—é –∑–∞ ${day} –¥–Ω–µ–π!`);
                resetGame();
            }
            
            updateUI();
        }
        
        // –°–±—Ä–æ—Å –∏–≥—Ä—ã
        function resetGame() {
            day = 1;
            gold = 100;
            silver = gems = credits = 0;
            Object.keys(resources).forEach(k => resources[k] = 0);
            Object.keys(buildings).forEach(k => buildings[k] = 0);
            eventsLog.innerHTML = "";
            updateUI();
        }
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        updateUI();
        setInterval(gameLoop, 10000); // 10 —Å–µ–∫—É–Ω–¥ = 1 –¥–µ–Ω—å
    </script>
</body>
</html>
