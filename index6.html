<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–¢–æ—Ä–≥–æ–≤—ã–π –¢–µ—Ä–º–∏–Ω–∞–ª 1984</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
      font-family: 'Courier New', monospace;
    }
    body {
      background: #000;
      color: #0f0;
      height: 100vh;
      overflow: hidden;
      padding: 10px;
      position: relative;
    }
    #screen {
      border: 2px solid #333;
      height: calc(70vh - 10px);
      padding: 10px;
      overflow: hidden;
      white-space: pre-wrap;
      margin-bottom: 10px;
    }
    #controls {
      border: 2px solid #333;
      height: calc(30vh - 20px);
      padding: 10px;
      display: flex;
      flex-direction: column;
    }
    .btn-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .btn {
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 5px 10px;
      cursor: pointer;
      flex-grow: 1;
      margin: 0 5px;
      text-align: center;
    }
    .btn:hover {
      background: #0f0;
      color: #000;
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .slider-container {
      display: flex;
      align-items: center;
      margin: 10px 0;
    }
    .slider-cursor {
      color: #0f0;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      50% { opacity: 0; }
    }
    .typed {
      border-right: 2px solid #0f0;
      animation: blink 0.5s infinite;
    }
    .up { color: #0f0; }
    .down { color: #f00; }
    .hidden { display: none; }
    .scrollable {
      overflow-y: auto;
      scrollbar-width: none;
    }
    .scrollable::-webkit-scrollbar {
      display: none;
    }
    #audio-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 100;
    }
  </style>
</head>
<body>
  <div id="screen" class="scrollable">> –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞...</div>
  <div id="controls" class="hidden"></div>
  <div id="audio-controls">
    <button class="btn" onclick="toggleAudio()">üîà –ó–≤—É–∫</button>
  </div>

  <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã -->
  <audio id="bg1" loop></audio>
  <audio id="bg2" loop></audio>
  <audio id="typing-sound"></audio>
  <audio id="day-start-sound"></audio>
  <audio id="news-sound"></audio>
  <audio id="click-sound"></audio>
  <audio id="buy-sound"></audio>
  <audio id="sell-sound"></audio>

  <script>
    // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    const gameState = {
      money: 1000,
      day: 1,
      assets: { usd: 0, eur: 0, gold: 0, oil: 0 },
      prices: { usd: 60, eur: 70, gold: 4500, oil: 80 },
      prevPrices: { usd: 60, eur: 70, gold: 4500, oil: 80 },
      trends: { usd: 0, eur: 0, gold: 0, oil: 0 },
      inventory: [],
      upgrades: { radar: false, briefcase: false },
      currentAction: null,
      selectedAsset: null,
      gameActive: false,
      audioEnabled: true,
      currentBgTrack: 1
    };

    // –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã
    const audio = {
      bg1: document.getElementById('bg1'),
      bg2: document.getElementById('bg2'),
      typing: document.getElementById('typing-sound'),
      dayStart: document.getElementById('day-start-sound'),
      news: document.getElementById('news-sound'),
      click: document.getElementById('click-sound'),
      buy: document.getElementById('buy-sound'),
      sell: document.getElementById('sell-sound')
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏–æ
    function initAudio() {
      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∑–≤—É–∫–æ–≤ (—Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
      audio.bg1.src = 'bg1.mp3';
      audio.bg2.src = 'bg2.mp3';
      audio.typing.src = 'typing.mp3';
      audio.dayStart.src = 'day-start.mp3';
      audio.news.src = 'news.mp3';
      audio.click.src = 'click.mp3';
      audio.buy.src = 'buy.mp3';
      audio.sell.src = 'sell.mp3';

      // –ù–∞—á–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏
      setVolume(audio.bg1, 0.15);
      setVolume(audio.bg2, 0);
      setVolume(audio.typing, 0.5);
      setVolume(audio.dayStart, 0.5);
      setVolume(audio.news, 0.5);
      setVolume(audio.click, 0.3);
      setVolume(audio.buy, 0.5);
      setVolume(audio.sell, 0.5);

      // –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏
      audio.bg1.play().catch(e => console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ"));
      audio.bg2.play().catch(e => console.log("–ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ"));
      
      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö —Ç—Ä–µ–∫–æ–≤ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
      setInterval(switchBackgroundTrack, 120000);
    }

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
    function setVolume(audioElem, volume) {
      if (audioElem) audioElem.volume = volume;
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö —Ç—Ä–µ–∫–æ–≤
    function switchBackgroundTrack() {
      if (!gameState.audioEnabled) return;
      
      if (gameState.currentBgTrack === 1) {
        fadeAudio(audio.bg1, audio.bg2, 0.15);
        gameState.currentBgTrack = 2;
      } else {
        fadeAudio(audio.bg2, audio.bg1, 0.15);
        gameState.currentBgTrack = 1;
      }
    }

    // –ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞—É–¥–∏–æ
    function fadeAudio(outAudio, inAudio, targetVolume) {
      if (!gameState.audioEnabled) return;
      
      const fadeTime = 3000; // 3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ –ø–µ—Ä–µ—Ö–æ–¥
      const steps = 30;
      const stepTime = fadeTime / steps;
      const volumeStep = targetVolume / steps;
      
      let step = 0;
      const fadeInterval = setInterval(() => {
        step++;
        
        // –£–º–µ–Ω—å—à–∞–µ–º –≥—Ä–æ–º–∫–æ—Å—Ç—å —É—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–µ–∫–∞
        if (outAudio.volume > 0) {
          outAudio.volume = Math.max(0, outAudio.volume - volumeStep);
        }
        
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≥—Ä–æ–º–∫–æ—Å—Ç—å –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–µ–∫–∞
        if (inAudio.volume < targetVolume) {
          inAudio.volume = Math.min(targetVolume, inAudio.volume + volumeStep);
        }
        
        if (step >= steps) {
          clearInterval(fadeInterval);
          outAudio.volume = 0;
          inAudio.volume = targetVolume;
        }
      }, stepTime);
    }

    // –í—Ä–µ–º–µ–Ω–Ω–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–∞
    function lowerBackgroundVolume() {
      if (!gameState.audioEnabled) return;
      
      const currentBg = gameState.currentBgTrack === 1 ? audio.bg1 : audio.bg2;
      currentBg.volume = 0.06;
    }

    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ —Ñ–æ–Ω–∞
    function restoreBackgroundVolume() {
      if (!gameState.audioEnabled) return;
      
      const currentBg = gameState.currentBgTrack === 1 ? audio.bg1 : audio.bg2;
      currentBg.volume = 0.15;
    }

    // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∑–≤—É–∫–∞
    function toggleAudio() {
      gameState.audioEnabled = !gameState.audioEnabled;
      
      if (gameState.audioEnabled) {
        document.querySelector('#audio-controls .btn').textContent = 'üîà –ó–≤—É–∫';
        const currentBg = gameState.currentBgTrack === 1 ? audio.bg1 : audio.bg2;
        currentBg.volume = 0.15;
      } else {
        document.querySelector('#audio-controls .btn').textContent = 'üîá –ó–≤—É–∫';
        audio.bg1.volume = 0;
        audio.bg2.volume = 0;
      }
    }

    // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —Å –ø–æ–Ω–∏–∂–µ–Ω–∏–µ–º —Ñ–æ–Ω–∞
    function playSound(sound, delay = 0) {
      if (!gameState.audioEnabled) return;
      
      setTimeout(() => {
        lowerBackgroundVolume();
        sound.currentTime = 0;
        sound.play().catch(e => console.log("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞"));
        
        sound.onended = () => {
          restoreBackgroundVolume();
        };
      }, delay);
    }

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const screen = document.getElementById('screen');
    const controls = document.getElementById('controls');
    let typingInterval;
    let currentText = '';
    let isTyping = false;

    // –û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
    function clearScreen(callback) {
      if (isTyping) {
        clearTimeout(typingInterval);
        isTyping = false;
      }
      
      let lines = screen.innerHTML.split('<br>');
      let i = lines.length;
      
      function deleteLine() {
        if (i > 0) {
          i--;
          screen.innerHTML = lines.slice(0, i).join('<br>');
          setTimeout(deleteLine, 50);
        } else {
          screen.innerHTML = '';
          if (callback) callback();
        }
      }
      
      deleteLine();
    }

    // –ü–µ—á–∞—Ç–∞–µ–º —Ç–µ–∫—Å—Ç —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –º–∞—à–∏–Ω–∫–∏
    function typeText(text, callback = null, speed = 30) {
      if (isTyping) {
        clearTimeout(typingInterval);
        isTyping = false;
      }
      
      // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –ø–µ—á–∞—Ç–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
      if (text.length > 10) {
        playSound(audio.typing);
      }
      
      let i = 0;
      currentText = screen.innerHTML;
      screen.innerHTML = currentText;
      isTyping = true;
      
      function typing() {
        if (i < text.length) {
          currentText += text.charAt(i);
          screen.innerHTML = currentText + '<span class="typed"></span>';
          i++;
          typingInterval = setTimeout(typing, speed);
        } else {
          isTyping = false;
          screen.innerHTML = currentText;
          if (audio.typing) audio.typing.pause();
          if (callback) callback();
        }
      }
      typing();
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—ã (—Å–ª—É—á–∞–π–Ω–æ + —Ç—Ä–µ–Ω–¥)
    function updatePrices() {
      Object.keys(gameState.prices).forEach(key => {
        gameState.prevPrices[key] = gameState.prices[key];
        const change = (Math.random() - 0.5) * 10 + gameState.trends[key];
        gameState.prices[key] = Math.max(1, gameState.prices[key] + change);
        gameState.trends[key] = (Math.random() - 0.5) * 2;
      });
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–µ–Ω–¥—ã (–µ—Å–ª–∏ –∫—É–ø–ª–µ–Ω —Ä–∞–¥–∞—Ä)
    function getTrendIndicator(asset) {
      if (!gameState.upgrades.radar) return '';
      return gameState.prices[asset] > gameState.prevPrices[asset] ? 
        '<span class="up">‚Üë</span>' : 
        '<span class="down">‚Üì</span>';
    }

    // –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
    function showMenu() {
      controls.innerHTML = '';
      gameState.currentAction = null;
      gameState.selectedAsset = null;

      clearScreen(() => {
        typeText(
          '> –¢–û–†–ì–û–í–´–ô –¢–ï–†–ú–ò–ù–ê–õ 1984\n' +
          '> –î–µ–Ω—å: ' + gameState.day + '\n' +
          '> –ë–∞–ª–∞–Ω—Å: $' + gameState.money.toFixed(2) + '\n' +
          (gameState.upgrades.radar ? '> –†–∞–¥–∞—Ä –∞–∫—Ç–∏–≤–µ–Ω (—Ç—Ä–µ–Ω–¥—ã: ‚Üë/‚Üì)\n' : '') +
          (gameState.upgrades.briefcase ? '> –ë–∞—Ä—Å–µ—Ç–∫–∞: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ–∫—É–ø–æ–∫\n' : '') +
          '\n|_ –¢–û–í–ê–†–´ _|\n' +
          '1. –î–æ–ª–ª–∞—Ä ($): ' + gameState.prices.usd.toFixed(2) + '‚ÇΩ' + getTrendIndicator('usd') + '\n' +
          '2. –ï–≤—Ä–æ (‚Ç¨): ' + gameState.prices.eur.toFixed(2) + '‚ÇΩ' + getTrendIndicator('eur') + '\n' +
          '3. –ó–æ–ª–æ—Ç–æ: ' + gameState.prices.gold.toFixed(2) + '‚ÇΩ' + getTrendIndicator('gold') + '\n' +
          '4. –ù–µ—Ñ—Ç—å: ' + gameState.prices.oil.toFixed(2) + '‚ÇΩ' + getTrendIndicator('oil') + '\n\n' +
          '|_ –î–ï–ô–°–¢–í–ò–Ø _|',
          () => {
            const btnRow1 = document.createElement('div');
            btnRow1.className = 'btn-row';
            btnRow1.innerHTML = `
              <button class="btn" onclick="playSound(audio.click); startAction('buy')">–ö—É–ø–∏—Ç—å</button>
              <button class="btn" onclick="playSound(audio.click); startAction('sell')">–ü—Ä–æ–¥–∞—Ç—å</button>
              <button class="btn" onclick="playSound(audio.click); nextDay()">–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å</button>
            `;
            controls.appendChild(btnRow1);

            const btnRow2 = document.createElement('div');
            btnRow2.className = 'btn-row';
            btnRow2.innerHTML = `
              <button class="btn" onclick="playSound(audio.click); showStats()">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
              <button class="btn" ${gameState.upgrades.radar ? 'disabled' : ''} 
                onclick="playSound(audio.click); buyUpgrade('radar')">–ö—É–ø–∏—Ç—å —Ä–∞–¥–∞—Ä (1500‚ÇΩ)</button>
              <button class="btn" ${gameState.upgrades.briefcase ? 'disabled' : ''} 
                onclick="playSound(audio.click); buyUpgrade('briefcase')">–ö—É–ø–∏—Ç—å –±–∞—Ä—Å–µ—Ç–∫—É (3000‚ÇΩ)</button>
            `;
            controls.appendChild(btnRow2);
          }
        );
      });
    }

    // –ù–∞—á–∞–ª–æ –¥–µ–π—Å—Ç–≤–∏—è (–ø–æ–∫—É–ø–∫–∞/–ø—Ä–æ–¥–∞–∂–∞)
    function startAction(action) {
      gameState.currentAction = action;
      clearScreen(() => {
        typeText('\n> –í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ–≤–∞—Ä (1-4): ', () => {
          const btnRow = document.createElement('div');
          btnRow.className = 'btn-row';
          btnRow.innerHTML = `
            <button class="btn" onclick="playSound(audio.click); selectAsset('usd')">–î–æ–ª–ª–∞—Ä ($)</button>
            <button class="btn" onclick="playSound(audio.click); selectAsset('eur')">–ï–≤—Ä–æ (‚Ç¨)</button>
            <button class="btn" onclick="playSound(audio.click); selectAsset('gold')">–ó–æ–ª–æ—Ç–æ</button>
            <button class="btn" onclick="playSound(audio.click); selectAsset('oil')">–ù–µ—Ñ—Ç—å</button>
            <button class="btn" onclick="playSound(audio.click); showMenu()">–û—Ç–º–µ–Ω–∞</button>
          `;
          controls.innerHTML = '';
          controls.appendChild(btnRow);
        });
      });
    }

    // –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–∞
    function selectAsset(asset) {
      gameState.selectedAsset = asset;
      clearScreen(() => {
        if (gameState.currentAction === 'buy') {
          const maxBuyQty = Math.floor(gameState.money / gameState.prices[asset]);
          typeText(
            `\n> –ú–∞–∫—Å–∏–º—É–º –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å: ${maxBuyQty} ${asset}\n` +
            '> –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ',
            () => showQuantitySlider(maxBuyQty)
          );
        } else if (gameState.currentAction === 'sell') {
          const ownedQty = gameState.assets[asset];
          if (ownedQty <= 0) {
            typeText('\n> –£ –≤–∞—Å –Ω–µ—Ç —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞!\n\n', showMenu);
          } else {
            typeText(
              `\n> –£ –≤–∞—Å –µ—Å—Ç—å: ${ownedQty} ${asset}\n` +
              '> –í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏: ',
              () => showQuantitySlider(ownedQty)
            );
          }
        }
      });
    }

    // –ü–æ–ª–∑—É–Ω–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
    function showQuantitySlider(maxQty) {
      controls.innerHTML = '';
      const sliderContainer = document.createElement('div');
      sliderContainer.className = 'slider-container';
      
      let qty = 1;
      const cursor = document.createElement('span');
      cursor.className = 'slider-cursor';
      cursor.textContent = '_';
      
      const updateDisplay = () => {
        sliderContainer.innerHTML = `
          <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${qty}</span>
          <input type="range" min="1" max="${maxQty}" value="${qty}" 
                 style="flex-grow: 1; margin: 0 10px;" 
                 oninput="this.nextElementSibling.nextElementSibling.textContent = this.value">
          ${cursor.outerHTML}
          <span>${qty}</span>
          <button class="btn" onclick="confirmAction(${qty})">OK</button>
        `;
      };
      
      updateDisplay();
      controls.appendChild(sliderContainer);
    }

    // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    function confirmAction(qty) {
      qty = parseInt(qty);
      const asset = gameState.selectedAsset;
      
      clearScreen(() => {
        if (gameState.currentAction === 'buy') {
          const cost = qty * gameState.prices[asset];
          if (cost <= gameState.money) {
            playSound(audio.buy);
            gameState.money -= cost;
            gameState.assets[asset] += qty;
            gameState.inventory.push({
              asset: asset,
              qty: qty,
              price: gameState.prices[asset],
              day: gameState.day
            });
            typeText(`\n> –ö—É–ø–ª–µ–Ω–æ: ${qty} ${asset} –∑–∞ ${cost.toFixed(2)}‚ÇΩ\n\n`, showMenu);
          } else {
            typeText('\n> –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!\n\n', showMenu);
          }
        } else if (gameState.currentAction === 'sell') {
          const income = qty * gameState.prices[asset];
          playSound(audio.sell);
          gameState.money += income;
          gameState.assets[asset] -= qty;
          typeText(`\n> –ü—Ä–æ–¥–∞–Ω–æ: ${qty} ${asset} –∑–∞ ${income.toFixed(2)}‚ÇΩ\n\n`, showMenu);
        }
      });
    }

    // –°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
    function nextDay() {
      playSound(audio.dayStart);
      gameState.day++;
      updatePrices();
      
      clearScreen(() => {
        // –°–ª—É—á–∞–π–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
        if (Math.random() < 0.3) {
          const events = [
            { msg: "> –ù–û–í–û–°–¢–ò: –í–æ–π–Ω–∞ –Ω–∞ –ë–ª–∏–∂–Ω–µ–º –í–æ—Å—Ç–æ–∫–µ! –¶–µ–Ω—ã –Ω–∞ –Ω–µ—Ñ—Ç—å —Ä–∞—Å—Ç—É—Ç.", effect: () => gameState.prices.oil *= 1.2 },
            { msg: "> –ù–û–í–û–°–¢–ò: –ö—Ä–∏–∑–∏—Å –≤ –ï–°! –ï–≤—Ä–æ –ø–∞–¥–∞–µ—Ç.", effect: () => gameState.prices.eur *= 0.8 },
            { msg: "> –ù–û–í–û–°–¢–ò: –ù–æ–≤—ã–µ —Å–∞–Ω–∫—Ü–∏–∏! –î–æ–ª–ª–∞—Ä –¥–æ—Ä–æ–∂–∞–µ—Ç.", effect: () => gameState.prices.usd *= 1.3 }
          ];
          const event = events[Math.floor(Math.random() * events.length)];
          event.effect();
          playSound(audio.news);
          typeText(event.msg + '\n\n', showMenu);
        } else {
          typeText('> –†—ã–Ω–æ–∫ –∏–∑–º–µ–Ω–∏–ª—Å—è...\n\n', showMenu);
        }
      });
    }

    // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π
    function buyUpgrade(type) {
      const cost = type === 'radar' ? 1500 : 3000;
      if (gameState.money >= cost) {
        playSound(audio.buy);
        gameState.money -= cost;
        gameState.upgrades[type] = true;
        typeText(`\n> –£–ª—É—á—à–µ–Ω–∏–µ "${type}" –∫—É–ø–ª–µ–Ω–æ!\n\n`, showMenu);
      } else {
        typeText('\n> –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!\n\n', showMenu);
      }
    }

    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –±–∞—Ä—Å–µ—Ç–∫–∞
    function showStats() {
      let total = gameState.money;
      Object.keys(gameState.assets).forEach(key => {
        total += gameState.assets[key] * gameState.prices[key];
      });
      
      let inventoryText = '';
      if (gameState.upgrades.briefcase && gameState.inventory.length > 0) {
        inventoryText = '\n> –ë–ê–†–°–ï–¢–ö–ê (–∏—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫):\n';
        gameState.inventory.forEach(item => {
          const currentValue = item.qty * gameState.prices[item.asset];
          const profit = currentValue - (item.qty * item.price);
          inventoryText += `- –î–µ–Ω—å ${item.day}: ${item.qty} ${item.asset} ` +
                          `(–∫—É–ø–ª–µ–Ω–æ –∑–∞ ${item.price.toFixed(2)}‚ÇΩ, ` +
                          `—Ç–µ–ø–µ—Ä—å ${gameState.prices[item.asset].toFixed(2)}‚ÇΩ | ` +
                          `–ü—Ä–∏–±—ã–ª—å: ${profit.toFixed(2)}‚ÇΩ)\n`;
        });
      }
      
      clearScreen(() => {
        typeText(
          `\n> –í–ê–® –ö–ê–ü–ò–¢–ê–õ: ${total.toFixed(2)}‚ÇΩ\n` +
          `> –ù–∞–ª—á–∏–Ω—ã–µ: ${gameState.money.toFixed(2)}‚ÇΩ\n` +
          `> –ê–∫—Ç–∏–≤—ã:\n` +
          `- –î–æ–ª–ª–∞—Ä: ${gameState.assets.usd} ($${(gameState.assets.usd * gameState.prices.usd).toFixed(2)})\n` +
          `- –ï–≤—Ä–æ: ${gameState.assets.eur} (‚Ç¨${(gameState.assets.eur * gameState.prices.eur).toFixed(2)})\n` +
          `- –ó–æ–ª–æ—Ç–æ: ${gameState.assets.gold} (${(gameState.assets.gold * gameState.prices.gold).toFixed(2)}‚ÇΩ)\n` +
          `- –ù–µ—Ñ—Ç—å: ${gameState.assets.oil} (${(gameState.assets.oil * gameState.prices.oil).toFixed(2)}‚ÇΩ)\n` +
          inventoryText + '\n',
          showMenu
        );
      });
    }

    // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
    function initGame() {
      initAudio();
      clearScreen(() => {
        playSound(audio.typing);
        typeText('> –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã...\n', () => {
          setTimeout(() => {
            playSound(audio.typing);
            typeText('> –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∏—Ä–∂–µ...\n', () => {
              setTimeout(() => {
                playSound(audio.typing);
                typeText('> –ì–æ—Ç–æ–≤–æ!\n\n', () => {
                  controls.classList.remove('hidden');
                  showMenu();
                  gameState.gameActive = true;
                });
              }, 800);
            });
          }, 800);
        });
      });
    }

    // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
    window.onload = () => {
      setTimeout(initGame, 500);
    };
  </script>
</body>
</html>
